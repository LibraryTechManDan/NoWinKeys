# Disable-WinA.ps1

# Auto-elevate if not already running as admin
if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole(`
    [Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Start-Process powershell -ArgumentList "-NoProfile -ExecutionPolicy Bypass -File `"$PSCommandPath`"" -Verb RunAs
    exit
}

# Disable Action Center (blocks Win + A)
$regPath = "HKCU:\Software\Policies\Microsoft\Windows\Explorer"
New-Item -Path $regPath -Force | Out-Null
Set-ItemProperty -Path $regPath -Name "DisableNotificationCenter" -Value 1 -Type DWord

# Log the change
Write-Output "[{0}] Disabled Action Center (Win + A disabled)" -f (Get-Date)

# Restart to apply
Restart-Computer -Force
